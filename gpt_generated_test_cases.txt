test_number|user_query|corresponding_sql_query|difficulty_level
1|Show me the data for Germany|SELECT * FROM eba_data WHERE Country = 'Germany';|Easy
2|Find the observed default rate for Italy|SELECT observed_default_rate FROM eba_data WHERE Country = 'Italy';|Easy
3|What's the average estimated_pd for Spain?|SELECT AVG(estimated_pd) FROM eba_data WHERE Country = 'Spain';|Medium
4|Give me the maximum observed_loss_rate for all countries|SELECT MAX(observed_loss_rate) FROM eba_data;|Medium
5|List the data for Retail segment in France|SELECT * FROM eba_data WHERE Country = 'France' AND Segment = 'Retail';|Medium
6|Which country has the highest estimated_lgd?|SELECT Country FROM eba_data WHERE estimated_lgd = (SELECT MAX(estimated_lgd) FROM eba_data);|Hard
7|Show the minimum estimated_pd for each country|SELECT Country, MIN(estimated_pd) FROM eba_data GROUP BY Country;|Hard
8|Find the average observed_loss_rate for Corporates segment in all EU countries|SELECT AVG(observed_loss_rate) FROM eba_data WHERE Segment = 'Corporates';|Medium
9|List the data for Belgium with observed_default_rate greater than 0.05|SELECT * FROM eba_data WHERE Country = 'Belgium' AND observed_default_rate > 0.05;|Medium
10|Display the estimated_lgd for Retail - Secured on real estate property segment in the Netherlands|SELECT estimated_lgd FROM eba_data WHERE Country = 'Netherlands' AND Segment = 'Retail - Secured on real estate property';|Hard
11|Which date has the lowest observed_default_rate for Portugal?|SELECT Date FROM eba_data WHERE Country = 'Portugal' AND observed_default_rate = (SELECT MIN(observed_default_rate) FROM eba_data WHERE Country = 'Portugal');|Hard
12|How many records are there for each segment?|SELECT Segment, COUNT(*) FROM eba_data GROUP BY Segment;|Easy
13|What is the total observed_loss_rate for all countries in the Corporates - Of Which: SME segment?|SELECT SUM(observed_loss_rate) FROM eba_data WHERE Segment = 'Corporates - Of Which: SME';|Medium
14|List the top 3 countries with the highest average observed_default_rate in Retail - Other Retail - Of Which: SME segment|SELECT Country FROM (SELECT Country, AVG(observed_default_rate) as avg_odr FROM eba_data WHERE Segment = 'Retail - Other Retail - Of Which: SME' GROUP BY Country ORDER BY avg_odr DESC LIMIT 3);|Very Hard
15|What is the correlation between observed_default_rate and estimated_pd for the 'Retail - Qualifying Revolving' segment?|SELECT CORR(observed_default_rate, estimated_pd) FROM eba_data WHERE Segment = 'Retail - Qualifying Revolving';|Very Hard
16|Find the total observed_loss_rate for each country in Retail - Secured on real estate property - Of Which: non-SME segment, where estimated_lgd is greater than 0.5|SELECT Country, SUM(observed_loss_rate) FROM eba_data WHERE Segment = 'Retail - Secured on real estate property - Of Which: non-SME' AND estimated_lgd > 0.5 GROUP BY Country;|Very Hard
17|Find the dates when the estimated_pd was at least 2 times higher than the average estimated_pd for the same country and segment|SELECT Date, Country, Segment FROM eba_data WHERE estimated_pd >= (SELECT AVG(estimated_pd) * 2 FROM eba_data AS eba_data_inner WHERE eba_data_inner.Country = eba_data.Country AND eba_data_inner.Segment = eba_data.Segment);|Ultra Hard
18|Find the country with the highest increase in observed_default_rate between the earliest and latest date in the dataset|SELECT Country FROM eba_data WHERE (Country, observed_default_rate - (SELECT MIN(observed_default_rate) FROM eba_data AS eba_data_inner WHERE eba_data_inner.Country = eba_data.Country)) IN (SELECT Country, MAX(observed_default_rate) - MIN(observed_default_rate) FROM eba_data GROUP BY Country);|Ultra Hard
19|Calculate the ratio of average estimated_lgd to average estimated_pd for each segment, and rank them in descending order|SELECT Segment, AVG(estimated_lgd) / AVG(estimated_pd) as ratio FROM eba_data GROUP BY Segment ORDER BY ratio DESC;|Ultra Hard
20|Find the median observed_default_rate for each country in the Retail - Secured on real estate property - Of Which: SME segment|SELECT Country, AVG(observed_default_rate) as median_odr FROM (SELECT Country, observed_default_rate, ROW_NUMBER() OVER (PARTITION BY Country ORDER BY observed_default_rate) as row_number, COUNT() OVER (PARTITION BY Country) as total_rows FROM eba_data WHERE Segment = 'Retail - Secured on real estate property - Of Which: SME') WHERE row_number IN (total_rows / 2, total_rows / 2 + 1) GROUP BY Country;|Ultra Hard
21|What is the standard deviation of observed_loss_rate for each segment?|SELECT Segment, (SUM(observed_loss_rate * observed_loss_rate) / COUNT() - AVG(observed_loss_rate) * AVG(observed_loss_rate)) * (1.0 / (COUNT(*) - 1)) AS stddev_observed_loss_rate FROM eba_data GROUP BY Segment;|Ultra Hard
22|Find the top 3 countries with the highest ratio of average observed_default_rate to average estimated_pd for Retail - Other Retail - Of Which: non-SME segment|SELECT Country FROM (SELECT Country, AVG(observed_default_rate) / AVG(estimated_pd) as ratio FROM eba_data WHERE Segment = 'Retail - Other Retail - Of Which: non-SME' GROUP BY Country ORDER BY ratio DESC LIMIT 3);|Ultra Hard
23|Calculate the percentage change in average estimated_lgd between the first half and second half of the year 2022 for each country|WITH FirstHalf AS (SELECT Country, AVG(estimated_lgd) as avg_lgd_first_half FROM eba_data WHERE Date BETWEEN '2022-01-01' AND '2022-06-30' GROUP BY Country), SecondHalf AS (SELECT Country, AVG(estimated_lgd) as avg_lgd_second_half FROM eba_data WHERE Date BETWEEN '2022-07-01' AND '2022-12-31' GROUP BY Country) SELECT FirstHalf.Country, ((SecondHalf.avg_lgd_second_half - FirstHalf.avg_lgd_first_half) / FirstHalf.avg_lgd_first_half) * 100 as percentage_change FROM FirstHalf JOIN SecondHalf ON FirstHalf.Country = SecondHalf.Country;|Ultra Hard